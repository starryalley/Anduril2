// Noctigon KR4 (fetless) config options for Anduril
// (and Noctigon KR1)
// (and Emisar D4v2 E21A, a.k.a. "D4v2.5")
#include "cfg-noctigon-kr4.h"
#undef MODEL_NUMBER
#define MODEL_NUMBER "0212"
// ATTINY: 1634

// brightness w/ SST-20 4000K LEDs:
// 0/1023: 0.35 lm
// 1/1023: 2.56 lm
// max regulated: 1740 lm
// level_calc.py 3.0 1 150 7135 0 5 1740
#undef PWM_CHANNELS
#define PWM_CHANNELS 1
#undef RAMP_LENGTH
#define RAMP_LENGTH 250
#undef PWM1_LEVELS
//#define PWM1_LEVELS 0,0,1,1,2,2,3,3,4,4,5,5,6,7,8,9,10,11,12,13,15,16,17,18,20,21,23,24,26,27,29,31,33,35,37,39,41,43,45,48,50,53,55,58,61,63,66,69,72,75,79,82,85,89,92,96,100,104,108,112,116,120,125,129,134,138,143,148,153,158,163,169,174,180,185,191,197,203,209,215,222,228,235,242,248,255,263,270,277,285,292,300,308,316,324,333,341,350,359,368,377,386,395,405,414,424,434,444,454,465,475,486,497,508,519,531,542,554,566,578,590,603,615,628,641,654,667,680,694,708,722,736,750,765,779,794,809,825,840,856,872,888,904,920,937,954,971,988,1005,1023
// level_calc.py 3.0 1 250 7135 0 1 4095 1740
#define PWM1_LEVELS 0,0,1,1,1,2,2,3,3,4,5,5,6,7,8,9,9,10,11,12,13,15,16,17,18,20,21,23,24,26,27,29,31,33,35,37,39,41,43,45,48,50,53,55,58,61,64,67,70,73,76,79,82,86,90,93,97,101,105,109,113,117,121,126,130,135,140,145,150,155,160,165,171,176,182,188,194,200,206,212,218,225,232,238,245,252,259,267,274,282,290,297,305,313,322,330,339,347,356,365,374,384,393,403,413,422,432,443,453,464,474,485,496,507,519,530,542,554,566,578,591,603,616,629,642,655,669,682,696,710,724,739,753,768,783,798,813,829,845,861,877,893,910,926,943,960,978,995,1013,1031,1049,1067,1086,1105,1124,1143,1163,1182,1202,1222,1243,1263,1284,1305,1326,1348,1369,1391,1414,1436,1459,1481,1505,1528,1552,1575,1599,1624,1648,1673,1698,1724,1749,1775,1801,1827,1854,1881,1908,1935,1963,1991,2019,2047,2076,2105,2134,2163,2193,2223,2253,2284,2315,2346,2377,2409,2441,2473,2505,2538,2571,2604,2638,2672,2706,2741,2776,2811,2846,2882,2918,2954,2990,3027,3064,3102,3140,3178,3216,3255,3294,3333,3373,3413,3453,3493,3534,3576,3617,3659,3701,3743,3786,3829,3873,3917,3961,4005,4050,4095
#undef PWM2_LEVELS
#undef DEFAULT_LEVEL
#define DEFAULT_LEVEL 80
#undef MAX_1x7135
#define MAX_1x7135 250

#undef RAMP_SMOOTH_FLOOR
#undef RAMP_SMOOTH_CEIL
#undef RAMP_DISCRETE_FLOOR
#undef RAMP_DISCRETE_CEIL
#undef RAMP_DISCRETE_STEPS

#define RAMP_SMOOTH_FLOOR 1
#define RAMP_SMOOTH_CEIL  220
// 10, 30, [50], 70, 90, 110, 130  (plus [150] on turbo)
#define RAMP_DISCRETE_FLOOR 10
#define RAMP_DISCRETE_CEIL  RAMP_SMOOTH_CEIL
#define RAMP_DISCRETE_STEPS 7

// safe limit ~67% power / ~1200 lm (can sustain 900 lm)
#undef SIMPLE_UI_FLOOR
#undef SIMPLE_UI_CEIL
#define SIMPLE_UI_FLOOR RAMP_DISCRETE_FLOOR
#define SIMPLE_UI_CEIL RAMP_DISCRETE_CEIL


// make candle mode wobble more
#define CANDLE_AMPLITUDE 28

// slow down party strobe; this driver can't pulse for 1ms or less
// (only needed on no-FET build)
#define PARTY_STROBE_ONTIME 2

// stop panicking at ~90% power or ~1600 lm
#undef THERM_FASTER_LEVEL
#define THERM_FASTER_LEVEL 230
#undef MIN_THERM_STEPDOWN
#define MIN_THERM_STEPDOWN DEFAULT_LEVEL

#define USE_UNLOCK_TO_OFF